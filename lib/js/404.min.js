/* (c) IGOR KOWALCZYK. All rights reserved. */

const $=(e,t=document)=>t.querySelector(e),$$=(e,t=document)=>t.querySelectorAll(e);var interval,easteregg=$(".easteregg"),game=$(".game",easteregg),confirmButton=$(".confirm",easteregg),upButton=$(".controls .up",game),downButton=$(".controls .down",game),startButton=$(".start",game),closeButton=$(".close",game),ball={elem:$(".ball",game),x:0,y:0,top:0,left:0},one={elem:$(".paddle.one",game),y:0,top:0,score:0},two={elem:$(".paddle.two",game),y:0,score:0};function init(){game.classList.contains("idle")&&(one.y=game.offsetHeight/2-one.elem.offsetHeight/2,two.y=game.offsetHeight/2-one.elem.offsetHeight/2,start(),game.classList.remove("idle"),game.classList.add("init"))}function start(){ball.x=game.offsetWidth/2-ball.elem.offsetWidth/2,ball.y=game.offsetHeight/2-ball.elem.offsetHeight/2,ball.top=2*Math.random()+2,ball.left=1*Math.random()*2+2,interval=window.setInterval(render,1e3/60)}function render(){one.y+=one.top,two.y=ball.y-two.elem.offsetHeight/2,ball.x+=ball.left,ball.y+=ball.top,one.y<=0&&(one.y=0),two.y<=0&&(two.y=0),one.y>=game.offsetHeight-one.elem.offsetHeight&&(one.y=game.offsetHeight-one.elem.offsetHeight),two.y>game.offsetHeight-two.elem.offsetHeight&&(two.y=game.offsetHeight-two.elem.offsetHeight),(ball.y<=0||ball.y>=game.offsetHeight-ball.elem.offsetHeight)&&(ball.top=-ball.top),ball.x<=one.elem.offsetWidth-2&&(ball.y+ball.elem.offsetHeight/2>one.y&&ball.y+ball.elem.offsetHeight/2<one.y+one.elem.offsetHeight?ball.left=-ball.left:(two.score++,setTimeout(()=>game.classList.add("idle"),100),clearInterval(interval))),ball.x>=game.offsetWidth-ball.elem.offsetWidth-(two.elem.offsetWidth-2)&&(ball.y+ball.elem.offsetHeight/2>two.y&&ball.y+ball.elem.offsetHeight/2<two.y+two.elem.offsetHeight?ball.left=-ball.left:(one.score++,setTimeout(()=>game.classList.add("idle"),100),clearInterval(interval))),one.elem.style.setProperty("--y",one.y+"px"),two.elem.style.setProperty("--y",two.y+"px"),ball.elem.style.setProperty("--x",ball.x+"px"),ball.elem.style.setProperty("--y",ball.y+"px")}startButton.addEventListener("click",init),confirmButton.addEventListener("click",e=>{easteregg.classList.add("show-game")}),closeButton.addEventListener("click",e=>{easteregg.classList.add("hide-game"),easteregg.classList.remove("show-game"),setTimeout(()=>easteregg.classList.remove("hide-game"),100)}),document.addEventListener("keydown",e=>{e.preventDefault(),init(),38!=e.keyCode&&38!=e.which||(one.top=-8),40!=e.keyCode&&40!=e.which||(one.top=8)},!1),document.addEventListener("keyup",e=>{e.preventDefault(),init(),38!=e.keyCode&&38!=e.which||(one.top=0),40!=e.keyCode&&40!=e.which||(one.top=0)},!1),upButton.onmousedown=(e=>{init(),one.top=-8}),downButton.onmousedown=(e=>{init(),one.top=8}),upButton.onmouseup=(e=>{one.top=0}),downButton.onmouseup=(e=>{one.top=0}),upButton.ontouchstart=(e=>{init(),one.top=-8}),downButton.ontouchstart=(e=>{init(),one.top=8}),upButton.ontouchend=(e=>{one.top=0}),downButton.ontouchend=(e=>{one.top=0});const toggletheme=document.querySelector('.theme-switch input[type="checkbox"]'),currenttheme=localStorage.getItem("theme"),meta=document.querySelector('meta[name="theme-color"]');function switchtheme(e){e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),meta.setAttribute("content","#222"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),meta.setAttribute("content","#ffffff"),localStorage.setItem("theme","light"))}currenttheme&&(document.documentElement.setAttribute("data-theme",currenttheme),"dark"===currenttheme&&(toggletheme.checked=!0)),toggletheme.addEventListener("change",switchtheme,!1),document.addEventListener("click",function(e){if("A"===e.target.tagName&&e.target.href&&"_blank"!=e.target.target&&"anchor-link"!=e.target.classList){e.preventDefault();var t=e.target;document.body.style.opacity=0,document.body.addEventListener("transitionend",function(){location.href=t.href})}});var date=document.querySelector(".date");date.innerHTML=(new Date).getFullYear();